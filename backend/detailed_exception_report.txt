Detailed Exception Usage Analysis
================================================================================

Total issues found: 203
Files affected: 25


## FynloException code to error code (85 issues)
--------------------------------------------------------------------------------

### api/v1/endpoints/admin.py
  Line 76: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 162: raise FynloException(message='', code='INTERNAL_ERROR')...

### api/v1/endpoints/auth.py
  Line 50: raise FynloException(message='Authentication service temporarily unavailable. Please check backend c...
  Line 57: raise FynloException(message='Authentication service returned invalid response', code='INTERNAL_ERRO...
  Line 75: raise FynloException(message='Database error while retrieving user information', code='INTERNAL_ERRO...
  Line 101: raise FynloException(message='Failed to create user account. Please try again.', code='INTERNAL_ERRO...
  Line 105: raise FynloException(message='Database error while creating user account', code='INTERNAL_ERROR')...
  Line 109: raise FynloException(message='Database error while creating user account', code='INTERNAL_ERROR')...
  Line 211: raise FynloException(message='Authentication service configuration error. Please contact support.', ...
  Line 213: raise FynloException(message='Authentication service error. Please try again later.', code='INTERNAL...
  Line 226: raise FynloException(message='Authentication service temporarily unavailable. Please check backend c...
  Line 258: raise FynloException(message='No platform found. Please contact support.', code='INTERNAL_ERROR')...
  Line 285: raise FynloException(message='Failed to register restaurant. Please try again.', code='INTERNAL_ERRO...
  Line 291: raise FynloException(message='Failed to register restaurant', code='INTERNAL_ERROR')...

### api/v1/endpoints/config.py
  Line 48: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 59: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 73: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 90: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 100: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 124: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 134: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 144: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 154: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 172: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 182: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 196: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 206: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 221: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 231: raise FynloException(message='', code='INTERNAL_ERROR')...

### api/v1/endpoints/fees.py
  Line 73: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 80: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 95: raise FynloException(message='', code='INTERNAL_ERROR')...

### api/v1/endpoints/orders.py
  Line 230: raise FynloException(message='Failed to create order', code='INTERNAL_ERROR')...
  Line 306: raise FynloException(message='', code='INTERNAL_ERROR')...

### api/v1/endpoints/payment_configurations.py
  Line 45: raise FynloException(message='Failed to create platform default setting.', code='INTERNAL_ERROR')...
  Line 50: raise FynloException(message=f"Failed to create setting: {str(e)}", code='INTERNAL_ERROR')...
  Line 80: raise FynloException(message='Failed to save restaurant setting.', code='INTERNAL_ERROR')...
  Line 85: raise FynloException(message=f"Failed to save setting for restaurant {restaurant_id}: {str(e)}", cod...

### api/v1/endpoints/payments.py
  Line 168: raise FynloException(message='Payment confirmation failed', code='INTERNAL_ERROR')...
  Line 220: raise FynloException(message='Payment processing failed', code='INTERNAL_ERROR')...
  Line 316: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 339: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 441: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 482: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 504: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 517: raise FynloException(message='Webhook secret not configured.', code='INTERNAL_ERROR')...
  Line 531: raise FynloException(message='Webhook event construction error', code='INTERNAL_ERROR')...

### api/v1/endpoints/platform_settings.py
  Line 58: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 69: raise FynloException(message='Failed to retrieve service charge configuration', code='INTERNAL_ERROR...
  Line 78: raise FynloException(message='Failed to update some service charge settings', code='INTERNAL_ERROR')...
  Line 85: raise FynloException(message='Failed to update service charge configuration', code='INTERNAL_ERROR')...
  Line 99: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 117: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 138: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 148: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 162: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 172: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 186: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 196: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 207: raise FynloException(message='Failed to initialize default settings', code='INTERNAL_ERROR')...
  Line 209: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 219: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 231: raise FynloException(message='Failed to set restaurant override', code='INTERNAL_ERROR')...
  Line 235: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 256: raise FynloException(message='', code='INTERNAL_ERROR')...
  Line 269: raise FynloException(message='', code='INTERNAL_ERROR')...

### api/v1/endpoints/platform_settings_public.py
  Line 74: raise FynloException(message='', code='INTERNAL_ERROR')...

### api/v1/endpoints/restaurants.py
  Line 138: raise FynloException(message='No default platform found', code='INTERNAL_ERROR')...

### api/v1/endpoints/tips.py
  Line 39: raise FynloException(message='', code='INTERNAL_ERROR')...

### core/two_factor_auth.py
  Line 82: raise FynloException(message='Service temporarily unavailable', code='SERVICE_UNAVAILABLE')...
  Line 155: raise FynloException(message='Service temporarily unavailable', code='SERVICE_UNAVAILABLE')...

### services/employee_service.py
  Line 81: raise FynloException("Access denied to this employee", status_code=403)...
  Line 109: raise FynloException("Access denied to this restaurant", status_code=403)...
  Line 189: raise FynloException("Access denied to this employee", status_code=403)...
  Line 229: raise FynloException("Access denied to this employee", status_code=403)...
  Line 268: raise FynloException("Employee not found", status_code=404)...
  Line 299: raise FynloException("Employee not found", status_code=404)...
  Line 353: raise FynloException("Employee not found", status_code=404)...
  Line 461: raise FynloException("Access denied to this restaurant", status_code=403)...
  Line 537: raise FynloException("Access denied to this restaurant", status_code=403)...
  Line 631: raise FynloException("Employee not found", status_code=404)...
  Line 663: raise FynloException("Employee not found", status_code=404)...
  Line 702: raise FynloException("Access denied", status_code=403)...
  Line 738: raise FynloException("Access denied", status_code=403)...

### services/sync_service.py
  Line 84: raise FynloException(f"Sync failed: {str(e)}", status_code=500)...

## AuthenticationException remove code (39 issues)
--------------------------------------------------------------------------------

### api/v1/endpoints/auth.py
  Line 61: raise AuthenticationException(message='Invalid or expired token', code='TOKEN_EXPIRED')...
  Line 185: raise AuthenticationException(message='Token has expired. Please sign in again.', code='TOKEN_EXPIRE...
  Line 192: raise AuthenticationException(message='Authentication failed. Please sign in again.', code='INVALID_...

### api/v1/endpoints/dashboard.py
  Line 25: raise AuthenticationException(message='Not authorized to view this dashboard', code='UNAUTHORIZED')...

### api/v1/endpoints/menu_optimized.py
  Line 133: raise AuthenticationException(message='Permission denied', code='UNAUTHORIZED')...

### api/v1/endpoints/orders.py
  Line 103: raise AuthenticationException(message='Access denied: No restaurant assigned to user', code='UNAUTHO...
  Line 105: raise AuthenticationException(message='Access denied: You can only access orders from your own resta...
  Line 120: raise AuthenticationException(message='Access denied: No restaurant assigned to user', code='UNAUTHO...
  Line 122: raise AuthenticationException(message='Access denied: You can only view orders from your own restaur...
  Line 158: raise AuthenticationException(message='Access denied: No restaurant assigned to user', code='UNAUTHO...
  Line 160: raise AuthenticationException(message='Access denied: You can only view orders from your own restaur...
  Line 182: raise AuthenticationException(message='Access denied: No restaurant assigned to user', code='UNAUTHO...
  Line 184: raise AuthenticationException(message='Access denied: You can only create orders for your own restau...
  Line 342: raise AuthenticationException(message='Not authorized to perform refunds.', code='UNAUTHORIZED')...

### api/v1/endpoints/platform_admin.py
  Line 37: raise AuthenticationException(message='Access denied: Platform owner role required', code='UNAUTHORI...
  Line 94: raise AuthenticationException(message='Access denied: Platform owner role required', code='UNAUTHORI...

### api/v1/endpoints/restaurants.py
  Line 199: raise AuthenticationException(message='Access denied', code='UNAUTHORIZED')...
  Line 201: raise AuthenticationException(message='Access denied', code='UNAUTHORIZED')...
  Line 239: raise AuthenticationException(message='Access denied', code='UNAUTHORIZED')...
  Line 241: raise AuthenticationException(message='Access denied', code='UNAUTHORIZED')...
  Line 284: raise AuthenticationException(message='Access denied', code='UNAUTHORIZED')...
  Line 286: raise AuthenticationException(message='Access denied', code='UNAUTHORIZED')...

### core/auth.py
  Line 25: raise AuthenticationException(message='Authentication required', code='MISSING_AUTH_HEADER')...
  Line 32: raise AuthenticationException(message='Authentication failed', code='INVALID_TOKEN')...
  Line 36: raise AuthenticationException(message='Authentication failed', code='AUTHENTICATION_FAILED')...
  Line 39: raise AuthenticationException(message='Access denied', code='ACCESS_DENIED')...
  Line 46: raise AuthenticationException(message='Authentication failed', code='AUTHENTICATION_FAILED')...
  Line 57: raise AuthenticationException(message='Access denied', code='ACCESS_DENIED')...
  Line 63: raise AuthenticationException(message='Access denied', code='ACCESS_DENIED')...

### core/dependencies.py
  Line 42: raise AuthenticationException(message="Authentication failed", code="ACCESS_DENIED")...
  Line 120: raise AuthenticationException(message='Access denied', code='ACCESS_DENIED')...
  Line 175: raise AuthenticationException(message="Authentication failed", code="ACCESS_DENIED")...

### core/feature_gate.py
  Line 69: raise AuthenticationException(message="Authentication failed", code="ACCESS_DENIED")...

### core/tenant_security.py
  Line 93: raise AuthenticationException(message='Access denied', code='ACCESS_DENIED')...
  Line 106: raise AuthenticationException(message='Access denied', code='ACCESS_DENIED')...
  Line 179: raise AuthenticationException(message='Access denied', code='ACCESS_DENIED')...

### core/two_factor_auth.py
  Line 67: raise AuthenticationException(message='Access denied', code='ACCESS_DENIED')...
  Line 141: raise AuthenticationException(message='Authentication failed', code='AUTHENTICATION_FAILED')...
  Line 153: raise AuthenticationException(message='Authentication failed', code='AUTHENTICATION_FAILED')...

## ValidationException remove code (48 issues)
--------------------------------------------------------------------------------

### api/v1/endpoints/auth.py
  Line 246: raise ValidationException(message='User already has a restaurant', code='BAD_REQUEST')...
  Line 265: raise ValidationException(message='Invalid phone number format', code='BAD_REQUEST')...
  Line 269: raise ValidationException(message='', code='BAD_REQUEST')...

### api/v1/endpoints/config.py
  Line 82: raise ValidationException(message='No configuration changes provided', code='BAD_REQUEST')...
  Line 114: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 117: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 189: raise ValidationException(message='Hours must be between 1 and 168', code='INVALID_VALUE', field='Ho...
  Line 215: raise ValidationException(message='', code='BAD_REQUEST')...

### api/v1/endpoints/customers.py
  Line 113: raise ValidationException(message='Customer already exists', code='BAD_REQUEST')...
  Line 155: raise ValidationException(message='Insufficient loyalty points', code='BAD_REQUEST')...

### api/v1/endpoints/fees.py
  Line 64: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 78: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 93: raise ValidationException(message='', code='BAD_REQUEST')...

### api/v1/endpoints/inventory.py
  Line 21: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 53: raise ValidationException(message='SKU in path and body do not match.', code='BAD_REQUEST')...
  Line 83: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 109: raise ValidationException(message='', code='BAD_REQUEST')...

### api/v1/endpoints/orders.py
  Line 155: raise ValidationException(message='Restaurant ID is required for platform owners', code='MISSING_FIE...
  Line 179: raise ValidationException(message='Restaurant ID is required for platform owners', code='MISSING_FIE...
  Line 204: raise ValidationException(message='One or more products not found', code='BAD_REQUEST')...
  Line 210: raise ValidationException(message='', code='BAD_REQUEST')...

### api/v1/endpoints/payment_configurations.py
  Line 48: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 83: raise ValidationException(message='', code='BAD_REQUEST')...

### api/v1/endpoints/payments.py
  Line 143: raise ValidationException(message='QR payment expired', code='BAD_REQUEST')...
  Line 146: raise ValidationException(message='QR payment already processed', code='BAD_REQUEST')...
  Line 149: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 156: raise ValidationException(message='Order already paid', code='BAD_REQUEST')...
  Line 186: raise ValidationException(message='Order already paid', code='BAD_REQUEST')...
  Line 215: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 233: raise ValidationException(message='Order already paid', code='BAD_REQUEST')...
  Line 235: raise ValidationException(message='Insufficient cash received', code='BAD_REQUEST')...
  Line 288: raise ValidationException(message='Order already paid', code='BAD_REQUEST')...
  Line 333: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 418: raise ValidationException(message='Order already paid.', code='BAD_REQUEST')...
  Line 434: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 523: raise ValidationException(message='Invalid payload', code='BAD_REQUEST')...
  Line 527: raise ValidationException(message='Invalid signature', code='BAD_REQUEST')...

### api/v1/endpoints/platform_admin.py
  Line 52: raise ValidationException(message='Invalid verification code', code='BAD_REQUEST')...

### api/v1/endpoints/platform_settings.py
  Line 82: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 113: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 155: raise ValidationException(message='Amount must be positive', code='INVALID_VALUE', field='Amount')...
  Line 160: raise ValidationException(message='', code='BAD_REQUEST')...
  Line 233: raise ValidationException(message='', code='BAD_REQUEST')...

### api/v1/endpoints/recipes.py
  Line 29: raise ValidationException(message='', code='BAD_REQUEST')...

### api/v1/endpoints/restaurants.py
  Line 133: raise ValidationException(message='User already has a restaurant associated', code='BAD_REQUEST')...

### api/v1/endpoints/tips.py
  Line 37: raise ValidationException(message='', code='BAD_REQUEST')...

### core/auth.py
  Line 51: raise ValidationException(message='Inactive user', code='BAD_REQUEST')...

### core/two_factor_auth.py
  Line 85: raise ValidationException(message='2FA setup expired or invalid', code='BAD_REQUEST')...

## ResourceNotFoundException remove code (26 issues)
--------------------------------------------------------------------------------

### api/v1/endpoints/admin.py
  Line 54: raise ResourceNotFoundException(message='Provider not found', code='NOT_FOUND', resource_type='provi...

### api/v1/endpoints/auth.py
  Line 244: raise ResourceNotFoundException(message='User not found', code='NOT_FOUND', resource_type='user')...

### api/v1/endpoints/customers.py
  Line 126: raise ResourceNotFoundException(message='Customer not found', code='NOT_FOUND', resource_type='custo...
  Line 135: raise ResourceNotFoundException(message='Customer not found', code='NOT_FOUND', resource_type='custo...
  Line 153: raise ResourceNotFoundException(message='Customer not found', code='NOT_FOUND', resource_type='custo...
  Line 173: raise ResourceNotFoundException(message='Customer not found', code='NOT_FOUND', resource_type='custo...

### api/v1/endpoints/inventory.py
  Line 28: raise ResourceNotFoundException(message='Inventory item not found', code='NOT_FOUND', resource_type=...
  Line 40: raise ResourceNotFoundException(message='Inventory item not found', code='NOT_FOUND', resource_type=...
  Line 47: raise ResourceNotFoundException(message='Inventory item not found', code='NOT_FOUND', resource_type=...

### api/v1/endpoints/payments.py
  Line 116: raise ResourceNotFoundException(message='Order not found', code='NOT_FOUND', resource_type='order')...
  Line 140: raise ResourceNotFoundException(message='QR payment not found', code='NOT_FOUND', resource_type='pay...
  Line 153: raise ResourceNotFoundException(message='Associated order not found', code='NOT_FOUND', resource_typ...
  Line 183: raise ResourceNotFoundException(message='Order not found', code='NOT_FOUND', resource_type='order')...
  Line 230: raise ResourceNotFoundException(message='Order not found', code='NOT_FOUND', resource_type='order')...
  Line 259: raise ResourceNotFoundException(message='QR payment not found', code='NOT_FOUND', resource_type='pay...
  Line 285: raise ResourceNotFoundException(message='Order not found', code='NOT_FOUND', resource_type='order')...
  Line 327: raise ResourceNotFoundException(message='Payment not found', code='NOT_FOUND', resource_type='paymen...

### api/v1/endpoints/platform_admin.py
  Line 55: raise ResourceNotFoundException(message='User not found', code='NOT_FOUND', resource_type='user')...
  Line 75: raise ResourceNotFoundException(message='User not found', code='NOT_FOUND', resource_type='user')...

### api/v1/endpoints/products_secure.py
  Line 23: raise ResourceNotFoundException(message='Product not found', code='NOT_FOUND', resource_type='produc...
  Line 38: raise ResourceNotFoundException(message='Product not found', code='NOT_FOUND', resource_type='produc...

### api/v1/endpoints/restaurants.py
  Line 98: raise ResourceNotFoundException(message='Restaurant not found', code='NOT_FOUND', resource_type='res...
  Line 109: raise ResourceNotFoundException(message='Platform not found', code='NOT_FOUND', resource_type='platf...
  Line 197: raise ResourceNotFoundException(message='Restaurant not found', code='NOT_FOUND', resource_type='res...
  Line 237: raise ResourceNotFoundException(message='Restaurant not found', code='NOT_FOUND', resource_type='res...
  Line 282: raise ResourceNotFoundException(message='Restaurant not found', code='NOT_FOUND', resource_type='res...

## BusinessLogicException remove code (5 issues)
--------------------------------------------------------------------------------

### api/v1/endpoints/auth.py
  Line 263: raise BusinessLogicException(message='Restaurant name cannot be empty', code='OPERATION_NOT_ALLOWED'...

### api/v1/endpoints/payment_configurations.py
  Line 40: raise BusinessLogicException(message='Platform default settings cannot have a restaurant_id.', code=...

### api/v1/endpoints/platform_admin.py
  Line 72: raise BusinessLogicException(message='Cannot revoke your own platform owner role', code='OPERATION_N...
  Line 80: raise BusinessLogicException(message='Cannot revoke: This would leave no platform owners in the syst...

### api/v1/endpoints/tips.py
  Line 32: raise BusinessLogicException(message='Cannot distribute tips: No staff members assigned to the order...


## Automated Fix Commands
--------------------------------------------------------------------------------

1. Fix FynloException (change 'code=' to 'error_code='):
   find app -name '*.py' -exec sed -i '' 's/FynloException(\(.*\)code=/FynloException(\1error_code=/g' {} +

2. Fix AuthenticationException (remove 'code' parameter):
   Manual review recommended - patterns vary

3. Fix ValidationException (remove 'code' parameter):
   Manual review recommended - patterns vary


## Files to Review (sorted by issue count):
   31 issues: api/v1/endpoints/payments.py
   24 issues: api/v1/endpoints/platform_settings.py
   20 issues: api/v1/endpoints/auth.py
   20 issues: api/v1/endpoints/config.py
   15 issues: api/v1/endpoints/orders.py
   13 issues: api/v1/endpoints/restaurants.py
   13 issues: services/employee_service.py
    8 issues: core/auth.py
    7 issues: api/v1/endpoints/payment_configurations.py
    7 issues: api/v1/endpoints/platform_admin.py
    7 issues: api/v1/endpoints/inventory.py
    6 issues: core/two_factor_auth.py
    6 issues: api/v1/endpoints/fees.py
    6 issues: api/v1/endpoints/customers.py
    3 issues: core/tenant_security.py
    3 issues: core/dependencies.py
    3 issues: api/v1/endpoints/tips.py
    3 issues: api/v1/endpoints/admin.py
    2 issues: api/v1/endpoints/products_secure.py
    1 issues: core/feature_gate.py
    1 issues: api/v1/endpoints/platform_settings_public.py
    1 issues: api/v1/endpoints/menu_optimized.py
    1 issues: api/v1/endpoints/dashboard.py
    1 issues: api/v1/endpoints/recipes.py
    1 issues: services/sync_service.py
